### 测试概要表

| 测试层级               | 目标/范围                            | 主要用例                                                     | 依赖与工具                                  | 结果记录                            |
| ---------------------- | ------------------------------------ | ------------------------------------------------------------ | ------------------------------------------- | ----------------------------------- |
| 单元测试 (`pytest -q`) | service/AI mock、utils、repositories | 成功路径、非法输入、重试/回退                                | pytest + sqlite:///:memory: + mock provider | `backend/tests/*.py`                |
| 集成测试               | router→service→repo→DB               | 上传解析、AI JSON 校验、JWT 鉴权                             | FastAPI TestClient、内存 SQLite、假 JWT     | `backend/tests/test_*_router.py`    |
| 前端组件测试           | Recharts、force-graph、Zustand store | 节点渲染、图表数据绑定、状态切换                             | Vitest + React Testing Library + MSW        | `frontend/src/__tests__/*.test.tsx` |
| 端到端 API 测试        | 核心业务流程                         | Learning Map、Exam、Teacher Persona、Read-Along、Mistake、Path | pytest + httpx + mock storage               | `tests/e2e/test_workflows.py`       |
| 手动/探索测试          | UI 主题、交互细节、上传进度          | 蓝白主题一致性、错误提示、SSE                                | 浏览器 + Mock 后端                          | QA checklist/wiki                   |

### 前后交互测试表

| 接口/页面                                      | 前端动作                                 | 预期后端响应                            | 验证点                       | 状态     |
| ---------------------------------------------- | ---------------------------------------- | --------------------------------------- | ---------------------------- | -------- |
| `/api/v1/learning-map/upload-file`             | 上传 markdown/docx，展示 force-graph     | JSON nodes≥8、edges≥10，含 mastery      | 节点颜色映射、点击详情弹窗   | ✅        |
| `/api/v1/exam/upload`                          | 上传 PDF，显示题目列表+饼图              | questions[]、exam_analysis              | 题目可编辑，图表与 JSON 一致 | ✅        |
| `/api/v1/teacher/personas` + AI Chat           | 新建 persona、在聊天侧栏切换             | Persona CRUD JSON，AI 回复风格变更      | Markdown 预览、语气对比      | ✅        |
| `/api/v1/read-along/upload` & `/sections/{id}` | 上传文章，点击段落请求讲解               | sections[] + explanation                | 段落高亮、loading/错误提示   | ✅        |
| `/api/v1/mistake/analyze`                      | 批量提交错题                             | cause 分类 + remedial tasks + map nodes | 跳转到知识图谱节点           | ✅        |
| `/api/v1/path/generate`                        | 输入目标/时间，展示时间轴                | path_json + timeline_json               | 列表顺序 + Recharts 甘特     | ✅        |
| 通用 JWT 流程                                  | sessionStorage 注入 token 调用 apiClient | 401/403 处理、成功返回数据              | CORS、错误提示组件           | ✅        |
| SSE/轮询（Read-Along 可选）                    | 监听讲解流/轮询                          | streaming 文本或 JSON                   | 断线重连、loading 状态同步   | ⚠️ 待扩展 |

- `✅` 表示通过，`⚠️` 代表部分功能可选或待增强。