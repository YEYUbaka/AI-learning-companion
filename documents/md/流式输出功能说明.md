# ğŸš€ æµå¼è¾“å‡ºåŠŸèƒ½å·²å¯ç”¨

## âœ… å·²å®Œæˆ

### åç«¯ä¿®æ”¹
- âœ… æ·»åŠ  `/api/v1/ai/ask/stream` æµå¼æ¥å£
- âœ… å®ç° `ask_gpt_stream()` å‡½æ•°
- âœ… ä½¿ç”¨ Server-Sent Events (SSE) åè®®

### å‰ç«¯ä¿®æ”¹
- âœ… ä½¿ç”¨ `fetch()` API è¯»å–æµå¼æ•°æ®
- âœ… å®æ—¶æ›´æ–° AI å›ç­”å†…å®¹
- âœ… æ”¯æŒé€å­—æ˜¾ç¤º

## ğŸ”„ å·¥ä½œåŸç†

### åç«¯æµç¨‹
1. æ¥æ”¶å‰ç«¯è¯·æ±‚
2. è°ƒç”¨ OpenAI API çš„æµå¼æ¨¡å¼ (`stream=True`)
3. é€å—è¿”å› AI å›ç­”
4. é€šè¿‡ SSE æ ¼å¼å‘é€ç»™å‰ç«¯

### å‰ç«¯æµç¨‹
1. å‘é€è¯·æ±‚åˆ° `/api/v1/ai/ask/stream`
2. ä½¿ç”¨ `ReadableStream` è¯»å–æ•°æ®
3. è§£æ JSON æ ¼å¼çš„æ•°æ®å—
4. å®æ—¶æ›´æ–° UI æ˜¾ç¤º

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### 1. é‡å¯åç«¯
åœ¨åç«¯ç»ˆç«¯æŒ‰ `Ctrl+C` åœæ­¢æœåŠ¡ï¼Œç„¶åï¼š
```powershell
cd "F:\Cursor projects\Web\backend"
.\å¯åŠ¨.bat
```

### 2. åˆ·æ–°å‰ç«¯
åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:5173/ai
æŒ‰ `F5` åˆ·æ–°é¡µé¢

### 3. æµ‹è¯•æµå¼è¾“å‡º
è¾“å…¥é—®é¢˜ï¼š"å¸®æˆ‘å†™ä¸€ä»½ä¸‰å¤©çš„Pythonå­¦ä¹ è®¡åˆ’"

ä½ ä¼šçœ‹åˆ°ï¼š
- âœ… AI å›ç­”å®æ—¶æ˜¾ç¤ºï¼ˆä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°å‡ºç°ï¼‰
- âœ… ä¸éœ€è¦ç­‰å¾…å®Œæ•´å›ç­”
- âœ… ç±»ä¼¼ ChatGPT çš„ä½“éªŒ

## ğŸ“‹ æ¥å£è¯´æ˜

### æµå¼æ¥å£
- **URL**: `POST http://127.0.0.1:8000/api/v1/ai/ask/stream`
- **å‚æ•°**: `{ prompt: "ä½ çš„é—®é¢˜" }`
- **è¿”å›**: Server-Sent Events æµ

### éæµå¼æ¥å£ï¼ˆä¿ç•™ï¼‰
- **URL**: `POST http://127.0.0.1:8000/api/v1/ai/ask`
- **å‚æ•°**: `{ prompt: "ä½ çš„é—®é¢˜" }`
- **è¿”å›**: å®Œæ•´ JSON å“åº”

## âš™ï¸ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®æ ¼å¼

æ¯ä¸ªæ•°æ®å—ï¼š
```json
{
  "type": "content",
  "content": "éƒ¨åˆ†æ–‡æœ¬"
}
```

é”™è¯¯æ—¶ï¼š
```json
{
  "type": "error",
  "content": "é”™è¯¯ä¿¡æ¯"
}
```

å®Œæˆä¿¡å·ï¼š
```
data: [DONE]
```

### ä»£ç å…³é”®éƒ¨åˆ†

**åç«¯** (`backend/routers/ai.py`):
```python
@router.post("/ask/stream")
async def ask_ai_stream(question: AIQuestion):
    async def generate():
        async for chunk in ask_gpt_stream(question.prompt):
            yield f"data: {json.dumps(chunk, ensure_ascii=False)}\n\n"
    return StreamingResponse(generate(), media_type="text/event-stream")
```

**å‰ç«¯** (`frontend/src/pages/AIChat.jsx`):
```javascript
const reader = response.body.getReader();
const decoder = new TextDecoder();

while (true) {
  const { done, value } = await reader.read();
  if (done) break;
  // å¤„ç†æ•°æ®...
}
```

## ğŸ¯ ä¼˜åŠ¿

### ç”¨æˆ·ä½“éªŒ
- âš¡ **å³æ—¶åé¦ˆ**ï¼šç«‹å³çœ‹åˆ° AI å¼€å§‹å›ç­”
- ğŸ‘€ **è§†è§‰ä½“éªŒ**ï¼šé€å­—æ˜¾ç¤ºï¼Œæ›´æœ‰äº’åŠ¨æ„Ÿ
- â±ï¸ **æ„ŸçŸ¥æ›´å¿«**ï¼šä¸éœ€è¦ç­‰å¾…å®Œæ•´å›ç­”

### æŠ€æœ¯ä¼˜åŠ¿
- ğŸ“Š **é™ä½å»¶è¿Ÿ**ï¼šè¾¹ç”Ÿæˆè¾¹è¿”å›
- ğŸ’¾ **èŠ‚çœå†…å­˜**ï¼šä¸éœ€è¦ç¼“å­˜å®Œæ•´å“åº”
- ğŸ”„ **å¯ä¸­æ–­**ï¼šç”¨æˆ·å¯ä»¥éšæ—¶åœæ­¢

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éœ€è¦é‡å¯åç«¯**æ‰èƒ½ç”Ÿæ•ˆ
2. **æµè§ˆå™¨å…¼å®¹æ€§**ï¼šç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ
3. **ç½‘ç»œæ–­çº¿**ï¼šä¼šè‡ªåŠ¨æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
4. **å¹¶å‘è¯·æ±‚**ï¼šæ”¯æŒå¤šä¸ªåŒæ—¶è¯·æ±‚

## ğŸ› æ•…éšœæ’æŸ¥

### AI ä¸æ˜¾ç¤ºå†…å®¹
- æ£€æŸ¥åç«¯æ˜¯å¦é‡å¯
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
- æ£€æŸ¥ç½‘ç»œè¿æ¥

### æ˜¾ç¤ºé”™è¯¯
- æŸ¥çœ‹åç«¯ç»ˆç«¯æ—¥å¿—
- æ£€æŸ¥ `.env` æ–‡ä»¶é…ç½®
- éªŒè¯ API Key æ˜¯å¦æ­£ç¡®

### æµå¼ä¸­æ–­
- åˆ·æ–°é¡µé¢é‡è¯•
- æ£€æŸ¥åç«¯æ—¥å¿—
- ç¡®ä¿ç½‘ç»œç¨³å®š

---

**ç°åœ¨å°±å¯ä»¥æµ‹è¯•æµå¼è¾“å‡ºäº†ï¼** ğŸ‰

è®¿é—® http://localhost:5173/ai è¯•è¯•å§ï¼

