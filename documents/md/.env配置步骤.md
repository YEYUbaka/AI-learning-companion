# 📝 .env 配置步骤（详细版）

## 🎯 你的情况

你已经准备好了其他API的密钥，现在需要知道如何配置到 `.env` 文件中。

---

## 📍 第一步：找到并打开 .env 文件

### 方法1：使用文件资源管理器
1. 打开 `F:\Cursor projects\Web\backend` 文件夹
2. 点击"查看" -> 勾选"显示" -> "隐藏的项目"
3. 找到 `.env` 文件（注意前面有点）
4. 右键 -> 打开方式 -> 记事本

### 方法2：使用命令行
```powershell
cd "F:\Cursor projects\Web\backend"
notepad .env
```

---

## ✏️ 第二步：编辑 .env 文件

### 你当前的配置（保持不变）
```ini
# AI API 配置 - 硅基流动 DeepSeek
AI_API_KEY=sk-hrrwzmmxydqkpitunkfonggkghnnxoshuakucxarfxczpmab
AI_API_BASE_URL=https://api.siliconflow.cn/v1
AI_MODEL=deepseek-ai/DeepSeek-V3
```

### 添加其他模型配置

在文件末尾添加以下内容（根据你准备好的API，选择添加）：

#### 添加文心一言
```ini
# 文心一言 API 配置
WENXIN_API_KEY=你准备好的文心一言API密钥
WENXIN_API_BASE_URL=https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat
WENXIN_MODEL=ernie-bot-turbo
```

#### 添加星火
```ini
# 星火 API 配置
XINGHUO_API_KEY=你准备好的星火API密钥
XINGHUO_API_BASE_URL=https://spark-api.xf-yun.com/v1
XINGHUO_MODEL=general
```

#### 添加ChatGLM
```ini
# ChatGLM API 配置
CHATGLM_API_KEY=你准备好的ChatGLM API密钥
CHATGLM_API_BASE_URL=https://open.bigmodel.cn/api/paas/v4
CHATGLM_MODEL=glm-4
```

#### 添加Moonshot
```ini
# Moonshot API 配置
MOONSHOT_API_KEY=你准备好的Moonshot API密钥
MOONSHOT_API_BASE_URL=https://api.moonshot.cn/v1
MOONSHOT_MODEL=moonshot-v1-8k
```

---

## 📋 完整配置示例

假设你准备好了所有API密钥，完整的 `.env` 文件应该是这样：

```ini
# AI API 配置 - 硅基流动 DeepSeek（你当前的配置，保持不变）
AI_API_KEY=sk-hrrwzmmxydqkpitunkfonggkghnnxoshuakucxarfxczpmab
AI_API_BASE_URL=https://api.siliconflow.cn/v1
AI_MODEL=deepseek-ai/DeepSeek-V3

# AI模型提供商配置（可选，默认使用deepseek）
AI_PROVIDER=deepseek

# 文心一言 API 配置
WENXIN_API_KEY=你的文心一言API密钥
WENXIN_API_BASE_URL=https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat
WENXIN_MODEL=ernie-bot-turbo

# 星火 API 配置
XINGHUO_API_KEY=你的星火API密钥
XINGHUO_API_BASE_URL=https://spark-api.xf-yun.com/v1
XINGHUO_MODEL=general

# ChatGLM API 配置
CHATGLM_API_KEY=你的ChatGLM API密钥
CHATGLM_API_BASE_URL=https://open.bigmodel.cn/api/paas/v4
CHATGLM_MODEL=glm-4

# Moonshot API 配置
MOONSHOT_API_KEY=你的Moonshot API密钥
MOONSHOT_API_BASE_URL=https://api.moonshot.cn/v1
MOONSHOT_MODEL=moonshot-v1-8k
```

---

## ⚠️ 重要提示

### 1. API密钥格式
- ✅ **正确**：`WENXIN_API_KEY=abc123def456`
- ❌ **错误**：`WENXIN_API_KEY="abc123def456"`（不要加引号）
- ❌ **错误**：`WENXIN_API_KEY = abc123def456`（等号前后不要有空格）

### 2. 只配置你准备好的模型
- 不需要配置所有模型
- 只添加你已经有API密钥的模型
- 例如：如果你只有文心一言的密钥，就只添加文心一言的配置

### 3. 保存文件
- 编辑完成后，**保存文件**（Ctrl+S）
- 确保文件编码是 UTF-8

---

## 🚀 第三步：重启后端服务

### 必须重启！
修改 `.env` 文件后，**必须重启后端服务**才能生效。

1. 在后端PowerShell窗口按 `Ctrl+C` 停止服务
2. 重新运行 `.\start.bat` 或 `uvicorn main:app --reload`

---

## 🎯 第四步：如何使用

### 方法1：前端UI切换（推荐）✨

1. 访问：http://localhost:5173/ai
2. 在页面顶部的"选择模型"下拉框中选择模型
3. 直接提问，系统会使用你选择的模型

### 方法2：修改默认模型

如果你想默认使用某个模型，在 `.env` 文件中修改：

```ini
AI_PROVIDER=wenxin    # 改为你想默认使用的模型
```

然后重启后端服务。

---

## 🧪 测试配置

### 1. 检查配置是否生效
访问：http://127.0.0.1:8000/api/v1/ai/providers

应该返回：
```json
{
  "providers": ["deepseek", "wenxin", "xinghuo", "chatglm", "moonshot"],
  "current": "deepseek"
}
```

### 2. 测试前端切换
1. 访问：http://localhost:5173/ai
2. 查看"选择模型"下拉框
3. 应该能看到你配置的模型
4. 选择模型并提问测试

### 3. 检查错误
如果某个模型无法使用：
- 检查API密钥是否正确
- 检查是否配置了对应的密钥
- 查看后端日志中的错误信息

---

## 📝 配置示例（实际填写）

假设你的API密钥如下：
- 文心一言：`wenxin_abc123`
- 星火：`xinghuo_xyz789`
- ChatGLM：`chatglm_def456`

那么 `.env` 文件应该这样写：

```ini
# 你当前的DeepSeek配置（保持不变）
AI_API_KEY=sk-hrrwzmmxydqkpitunkfonggkghnnxoshuakucxarfxczpmab
AI_API_BASE_URL=https://api.siliconflow.cn/v1
AI_MODEL=deepseek-ai/DeepSeek-V3

# 文心一言
WENXIN_API_KEY=wenxin_abc123
WENXIN_API_BASE_URL=https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat
WENXIN_MODEL=ernie-bot-turbo

# 星火
XINGHUO_API_KEY=xinghuo_xyz789
XINGHUO_API_BASE_URL=https://spark-api.xf-yun.com/v1
XINGHUO_MODEL=general

# ChatGLM
CHATGLM_API_KEY=chatglm_def456
CHATGLM_API_BASE_URL=https://open.bigmodel.cn/api/paas/v4
CHATGLM_MODEL=glm-4
```

---

## ✅ 快速检查清单

- [ ] 打开 `backend/.env` 文件
- [ ] 保留现有的DeepSeek配置
- [ ] 添加你准备好的其他API密钥
- [ ] 保存文件（Ctrl+S）
- [ ] 重启后端服务
- [ ] 访问前端页面测试

---

**现在就去编辑 `.env` 文件，添加你的API密钥吧！** 🔑

